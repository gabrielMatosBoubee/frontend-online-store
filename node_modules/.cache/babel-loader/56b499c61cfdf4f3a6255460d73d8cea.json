{"ast":null,"code":"var _jsxFileName = \"/home/boubee/\\xC1rea de Trabalho/projetos/sd-025-b-project-frontend-online-store/src/components/ProdutoDetalhado.jsx\";\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport propTypes from 'prop-types';\nimport { getProductById } from '../services/api';\nimport FormComentarios from './FormComentarios';\nimport { SalvaProduto, recuperaProdutos } from '../localStorage/localStorage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass ProdutoDetalhado extends React.Component {\n  constructor() {\n    super();\n\n    this.onClickButton = () => {\n      const {\n        product\n      } = this.state;\n      const idQuantidade = `quantidade:${product[0].id}`;\n      this.salvarQuantidade(idQuantidade);\n      const produto = product;\n      const produtos = recuperaProdutos();\n\n      if (produtos !== null) {\n        const [produtoObj] = produto;\n        produtos.push(produtoObj);\n        this.setState({\n          produtosSalvos: produtos\n        }, () => {\n          const {\n            produtosSalvos\n          } = this.state;\n          SalvaProduto(produtosSalvos);\n        });\n      } else {\n        this.setState({\n          produtosSalvos: produto\n        }, () => {\n          const {\n            produtosSalvos\n          } = this.state;\n          SalvaProduto(produtosSalvos);\n        });\n      }\n    };\n\n    this.salvarQuantidade = elemento => {\n      let antes = localStorage.getItem(elemento);\n\n      if (antes === null) {\n        antes = 0;\n      }\n\n      const novo = parseInt(antes, 10) + 1;\n      localStorage.setItem(elemento, novo); //---------------------\n\n      this.calculaTotal();\n    };\n\n    this.calculaTotal = () => {\n      const listaDeItens = JSON.parse(localStorage.getItem('product'));\n\n      if (listaDeItens != null) {\n        const setArray = new Set();\n        const filtredArray = listaDeItens.filter(item => {\n          const duplicatedItem = setArray.has(item.id);\n          setArray.add(item.id);\n          return !duplicatedItem;\n        });\n        const ids = filtredArray.map(item => item.id);\n        const soma = ids.reduce((acc, numero) => {\n          const quantidade = localStorage.getItem(`quantidade:${numero}`);\n          acc += Number(quantidade);\n          return acc;\n        }, 0);\n        this.setState({\n          quantidadeCarrinho: soma\n        });\n      }\n    };\n\n    this.state = {\n      product: [],\n      loading: true,\n      produtosSalvos: [],\n      id: ''\n    };\n  }\n\n  async componentDidMount() {\n    const {\n      match: {\n        params: {\n          id\n        }\n      }\n    } = this.props;\n    const produtoDetalhado = await getProductById(id);\n    this.setState({\n      product: [produtoDetalhado],\n      loading: false,\n      id\n    });\n    this.calculaTotal();\n  }\n\n  render() {\n    const {\n      product,\n      loading,\n      id,\n      quantidadeCarrinho\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Carregando...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 20\n      }, this) : product.map((element, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          \"data-testid\": \"product-detail-name\",\n          children: element.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          \"data-testid\": \"product-detail-price\",\n          children: element.price\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: element.thumbnail,\n          alt: element.title,\n          \"data-testid\": \"product-detail-image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: element.shipping.free_shipping && /*#__PURE__*/_jsxDEV(\"h4\", {\n            \"data-testid\": \"free-shipping\",\n            children: \"Frete Gr\\xE1tis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 18\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          name: \"Add Cart\",\n          type: \"button\",\n          \"data-testid\": \"product-detail-add-to-cart\",\n          onClick: this.onClickButton,\n          children: \"Add Cart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(FormComentarios, {\n          productId: id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 15\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/cart\",\n        \"data-testid\": \"shopping-cart-button\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Cart\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            \"data-testid\": \"shopping-cart-size\",\n            children: quantidadeCarrinho\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nProdutoDetalhado.propTypes = {\n  match: propTypes.shape({\n    params: propTypes.shape({\n      id: propTypes.string.isRequired\n    }).isRequired\n  }).isRequired\n};\nexport default ProdutoDetalhado;","map":{"version":3,"names":["React","Link","propTypes","getProductById","FormComentarios","SalvaProduto","recuperaProdutos","ProdutoDetalhado","Component","constructor","onClickButton","product","state","idQuantidade","id","salvarQuantidade","produto","produtos","produtoObj","push","setState","produtosSalvos","elemento","antes","localStorage","getItem","novo","parseInt","setItem","calculaTotal","listaDeItens","JSON","parse","setArray","Set","filtredArray","filter","item","duplicatedItem","has","add","ids","map","soma","reduce","acc","numero","quantidade","Number","quantidadeCarrinho","loading","componentDidMount","match","params","props","produtoDetalhado","render","element","index","title","price","thumbnail","shipping","free_shipping","shape","string","isRequired"],"sources":["/home/boubee/Área de Trabalho/projetos/sd-025-b-project-frontend-online-store/src/components/ProdutoDetalhado.jsx"],"sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport propTypes from 'prop-types';\nimport { getProductById } from '../services/api';\nimport FormComentarios from './FormComentarios';\nimport {\n  SalvaProduto,\n  recuperaProdutos } from '../localStorage/localStorage';\n\nclass ProdutoDetalhado extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      product: [],\n      loading: true,\n      produtosSalvos: [],\n      id: '',\n    };\n  }\n\n  async componentDidMount() {\n    const { match: { params: { id } } } = this.props;\n    const produtoDetalhado = await getProductById(id);\n    this.setState({ product: [produtoDetalhado], loading: false, id });\n    this.calculaTotal();\n  }\n\n  onClickButton = () => {\n    const { product } = this.state;\n\n    const idQuantidade = `quantidade:${product[0].id}`;\n    this.salvarQuantidade(idQuantidade);\n\n    const produto = product;\n    const produtos = recuperaProdutos();\n    if (produtos !== null) {\n      const [produtoObj] = produto;\n      produtos.push(produtoObj);\n      this.setState({\n        produtosSalvos: produtos,\n      }, () => {\n        const { produtosSalvos } = this.state;\n        SalvaProduto(produtosSalvos);\n      });\n    } else {\n      this.setState({\n        produtosSalvos: produto,\n      }, () => {\n        const { produtosSalvos } = this.state;\n        SalvaProduto(produtosSalvos);\n      });\n    }\n  };\n\n  salvarQuantidade = (elemento) => {\n    let antes = localStorage.getItem(elemento);\n    if (antes === null) {\n      antes = 0;\n    }\n    const novo = parseInt(antes, 10) + 1;\n    localStorage.setItem(elemento, novo);\n    //---------------------\n    this.calculaTotal();\n  };\n\n  calculaTotal = () => {\n    const listaDeItens = JSON.parse(localStorage.getItem('product'));\n\n    if (listaDeItens != null) {\n      const setArray = new Set();\n      const filtredArray = listaDeItens.filter((item) => {\n        const duplicatedItem = setArray.has(item.id);\n        setArray.add(item.id);\n        return !duplicatedItem;\n      });\n      const ids = filtredArray.map((item) => item.id);\n      const soma = ids.reduce((acc, numero) => {\n        const quantidade = localStorage.getItem(`quantidade:${numero}`);\n        acc += Number(quantidade);\n        return acc;\n      }, 0);\n      this.setState({ quantidadeCarrinho: soma });\n    }\n  };\n\n  render() {\n    const { product, loading, id, quantidadeCarrinho } = this.state;\n    return (\n      <div>\n        {loading ? <p>Carregando...</p>\n          : product.map((element, index) => (\n            <div key={ index }>\n              <p data-testid=\"product-detail-name\">{ element.title }</p>\n              <p data-testid=\"product-detail-price\">{ element.price }</p>\n              <img\n                src={ element.thumbnail }\n                alt={ element.title }\n                data-testid=\"product-detail-image\"\n              />\n              <div>\n                {element.shipping.free_shipping\n              && <h4 data-testid=\"free-shipping\">Frete Grátis</h4>}\n\n              </div>\n              <button\n                name=\"Add Cart\"\n                type=\"button\"\n                data-testid=\"product-detail-add-to-cart\"\n                onClick={ this.onClickButton }\n              >\n                Add Cart\n              </button>\n              <FormComentarios productId={ id } />\n            </div>\n          ))}\n        <Link to=\"/cart\" data-testid=\"shopping-cart-button\">\n          <div>\n            <p>Cart</p>\n            <p data-testid=\"shopping-cart-size\">{quantidadeCarrinho}</p>\n          </div>\n        </Link>\n      </div>\n    );\n  }\n}\n\nProdutoDetalhado.propTypes = {\n  match: propTypes.shape({\n    params: propTypes.shape({\n      id: propTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n\nexport default ProdutoDetalhado;\n"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,cAAT,QAA+B,iBAA/B;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,SACEC,YADF,EAEEC,gBAFF,QAE0B,8BAF1B;;;AAIA,MAAMC,gBAAN,SAA+BP,KAAK,CAACQ,SAArC,CAA+C;EAC7CC,WAAW,GAAG;IACZ;;IADY,KAiBdC,aAjBc,GAiBE,MAAM;MACpB,MAAM;QAAEC;MAAF,IAAc,KAAKC,KAAzB;MAEA,MAAMC,YAAY,GAAI,cAAaF,OAAO,CAAC,CAAD,CAAP,CAAWG,EAAG,EAAjD;MACA,KAAKC,gBAAL,CAAsBF,YAAtB;MAEA,MAAMG,OAAO,GAAGL,OAAhB;MACA,MAAMM,QAAQ,GAAGX,gBAAgB,EAAjC;;MACA,IAAIW,QAAQ,KAAK,IAAjB,EAAuB;QACrB,MAAM,CAACC,UAAD,IAAeF,OAArB;QACAC,QAAQ,CAACE,IAAT,CAAcD,UAAd;QACA,KAAKE,QAAL,CAAc;UACZC,cAAc,EAAEJ;QADJ,CAAd,EAEG,MAAM;UACP,MAAM;YAAEI;UAAF,IAAqB,KAAKT,KAAhC;UACAP,YAAY,CAACgB,cAAD,CAAZ;QACD,CALD;MAMD,CATD,MASO;QACL,KAAKD,QAAL,CAAc;UACZC,cAAc,EAAEL;QADJ,CAAd,EAEG,MAAM;UACP,MAAM;YAAEK;UAAF,IAAqB,KAAKT,KAAhC;UACAP,YAAY,CAACgB,cAAD,CAAZ;QACD,CALD;MAMD;IACF,CA1Ca;;IAAA,KA4CdN,gBA5Cc,GA4CMO,QAAD,IAAc;MAC/B,IAAIC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqBH,QAArB,CAAZ;;MACA,IAAIC,KAAK,KAAK,IAAd,EAAoB;QAClBA,KAAK,GAAG,CAAR;MACD;;MACD,MAAMG,IAAI,GAAGC,QAAQ,CAACJ,KAAD,EAAQ,EAAR,CAAR,GAAsB,CAAnC;MACAC,YAAY,CAACI,OAAb,CAAqBN,QAArB,EAA+BI,IAA/B,EAN+B,CAO/B;;MACA,KAAKG,YAAL;IACD,CArDa;;IAAA,KAuDdA,YAvDc,GAuDC,MAAM;MACnB,MAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWR,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAX,CAArB;;MAEA,IAAIK,YAAY,IAAI,IAApB,EAA0B;QACxB,MAAMG,QAAQ,GAAG,IAAIC,GAAJ,EAAjB;QACA,MAAMC,YAAY,GAAGL,YAAY,CAACM,MAAb,CAAqBC,IAAD,IAAU;UACjD,MAAMC,cAAc,GAAGL,QAAQ,CAACM,GAAT,CAAaF,IAAI,CAACvB,EAAlB,CAAvB;UACAmB,QAAQ,CAACO,GAAT,CAAaH,IAAI,CAACvB,EAAlB;UACA,OAAO,CAACwB,cAAR;QACD,CAJoB,CAArB;QAKA,MAAMG,GAAG,GAAGN,YAAY,CAACO,GAAb,CAAkBL,IAAD,IAAUA,IAAI,CAACvB,EAAhC,CAAZ;QACA,MAAM6B,IAAI,GAAGF,GAAG,CAACG,MAAJ,CAAW,CAACC,GAAD,EAAMC,MAAN,KAAiB;UACvC,MAAMC,UAAU,GAAGvB,YAAY,CAACC,OAAb,CAAsB,cAAaqB,MAAO,EAA1C,CAAnB;UACAD,GAAG,IAAIG,MAAM,CAACD,UAAD,CAAb;UACA,OAAOF,GAAP;QACD,CAJY,EAIV,CAJU,CAAb;QAKA,KAAKzB,QAAL,CAAc;UAAE6B,kBAAkB,EAAEN;QAAtB,CAAd;MACD;IACF,CAzEa;;IAEZ,KAAK/B,KAAL,GAAa;MACXD,OAAO,EAAE,EADE;MAEXuC,OAAO,EAAE,IAFE;MAGX7B,cAAc,EAAE,EAHL;MAIXP,EAAE,EAAE;IAJO,CAAb;EAMD;;EAEsB,MAAjBqC,iBAAiB,GAAG;IACxB,MAAM;MAAEC,KAAK,EAAE;QAAEC,MAAM,EAAE;UAAEvC;QAAF;MAAV;IAAT,IAAgC,KAAKwC,KAA3C;IACA,MAAMC,gBAAgB,GAAG,MAAMpD,cAAc,CAACW,EAAD,CAA7C;IACA,KAAKM,QAAL,CAAc;MAAET,OAAO,EAAE,CAAC4C,gBAAD,CAAX;MAA+BL,OAAO,EAAE,KAAxC;MAA+CpC;IAA/C,CAAd;IACA,KAAKe,YAAL;EACD;;EA4DD2B,MAAM,GAAG;IACP,MAAM;MAAE7C,OAAF;MAAWuC,OAAX;MAAoBpC,EAApB;MAAwBmC;IAAxB,IAA+C,KAAKrC,KAA1D;IACA,oBACE;MAAA,WACGsC,OAAO,gBAAG;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAAH,GACJvC,OAAO,CAAC+B,GAAR,CAAY,CAACe,OAAD,EAAUC,KAAV,kBACZ;QAAA,wBACE;UAAG,eAAY,qBAAf;UAAA,UAAuCD,OAAO,CAACE;QAA/C;UAAA;UAAA;UAAA;QAAA,QADF,eAEE;UAAG,eAAY,sBAAf;UAAA,UAAwCF,OAAO,CAACG;QAAhD;UAAA;UAAA;UAAA;QAAA,QAFF,eAGE;UACE,GAAG,EAAGH,OAAO,CAACI,SADhB;UAEE,GAAG,EAAGJ,OAAO,CAACE,KAFhB;UAGE,eAAY;QAHd;UAAA;UAAA;UAAA;QAAA,QAHF,eAQE;UAAA,UACGF,OAAO,CAACK,QAAR,CAAiBC,aAAjB,iBACA;YAAI,eAAY,eAAhB;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA;QAFH;UAAA;UAAA;UAAA;QAAA,QARF,eAaE;UACE,IAAI,EAAC,UADP;UAEE,IAAI,EAAC,QAFP;UAGE,eAAY,4BAHd;UAIE,OAAO,EAAG,KAAKrD,aAJjB;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAbF,eAqBE,QAAC,eAAD;UAAiB,SAAS,EAAGI;QAA7B;UAAA;UAAA;UAAA;QAAA,QArBF;MAAA,GAAW4C,KAAX;QAAA;QAAA;QAAA;MAAA,QADA,CAFN,eA2BE,QAAC,IAAD;QAAM,EAAE,EAAC,OAAT;QAAiB,eAAY,sBAA7B;QAAA,uBACE;UAAA,wBACE;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADF,eAEE;YAAG,eAAY,oBAAf;YAAA,UAAqCT;UAArC;YAAA;YAAA;YAAA;UAAA,QAFF;QAAA;UAAA;UAAA;UAAA;QAAA;MADF;QAAA;QAAA;QAAA;MAAA,QA3BF;IAAA;MAAA;MAAA;MAAA;IAAA,QADF;EAoCD;;AAlH4C;;AAqH/C1C,gBAAgB,CAACL,SAAjB,GAA6B;EAC3BkD,KAAK,EAAElD,SAAS,CAAC8D,KAAV,CAAgB;IACrBX,MAAM,EAAEnD,SAAS,CAAC8D,KAAV,CAAgB;MACtBlD,EAAE,EAAEZ,SAAS,CAAC+D,MAAV,CAAiBC;IADC,CAAhB,EAELA;EAHkB,CAAhB,EAIJA;AALwB,CAA7B;AAQA,eAAe3D,gBAAf"},"metadata":{},"sourceType":"module"}